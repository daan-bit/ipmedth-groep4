import{r as o,j as s,a as e,R as G,d as j,F}from"./app.1c6f69ab.js";import{H as D}from"./GroupModel.9b4d7df6.js";import{S as z}from"./StackedBarChart.afc6ffd6.js";/* empty css               */import{M as O}from"./Modal.8d29cd28.js";import{R as E}from"./ResponsiveNavLink.05828d5a.js";import"./adminSettings.e8138818.js";import"./PrimaryButton.71e07542.js";import"./TextInput.5f482d34.js";/* empty css              */import"./InputError.d07709d6.js";function I(t){const[d,c]=o.exports.useState(),[h,g]=o.exports.useState(),[N,S]=o.exports.useState(),[w,p]=o.exports.useState(),[k,C]=o.exports.useState();let _=[];const[b,A]=o.exports.useState([[0],[0],[0],[0],[0]]),[M,$]=o.exports.useState([[0],[0],[0],[0],[0]]),[x,R]=o.exports.useState([[0],[0],[0],[0],[0]]);function P(){A([[0],[0],[0],[0],[0]]),$([[0],[0],[0],[0],[0]]),R([[0],[0],[0],[0],[0]]);for(let n=0;n<t.allResults.length;n++){let i=t.allResults[n];for(let l=0;l<t.assignments.length;l++){let m=t.assignments[l].id-1;i[l]==null?y(m,0):t.assignments[l].id==i[l].assignment_id&&(_.push(i[l].assignment_id),y(m,i[l].status))}}}function y(n,i){i==1?b[n][0]+=1:i==-1?M[n][0]+=1:i==0&&(x[n][0]+=1)}function a(){c(Math.round(_.reduce((n,i)=>n+i,0)/_.length)),g(Math.round(v(_))),S(f(_)),p(Math.min.apply(Math,_)),C(Math.max.apply(Math,_))}function v(n){if(n.length==0)return;n.sort((m,u)=>m-u);const i=Math.floor(n.length/2);return n.length%2===1?n[i]:(n[i-1]+n[i])/2}function f(n){const i={};let l=0,m=0;for(let u=0;u<n.length;u++){const r=n[u];i[r]?i[r]++:i[r]=1,m<i[r]&&(l=r,m=i[r])}return l}return s("article",{className:"OverviewPerGroupPage",children:[s("section",{className:"OverviewPerGroupPage__statisticContainer",children:[s("section",{className:"statisticContainer__statistic",children:[e("section",{className:"statistic__titleContainer",children:e("h3",{className:"bold",children:"Gemiddelde"})}),e("section",{className:"statistic__contentContainer",children:e("h3",{children:d||"-"})})]}),s("section",{className:"statisticContainer__statistic",children:[e("section",{className:"statistic__titleContainer",children:e("h3",{className:"bold",children:"Mediaan"})}),e("section",{className:"statistic__contentContainer",children:e("h3",{children:h||"-"})})]}),s("section",{className:"statisticContainer__statistic",children:[e("section",{className:"statistic__titleContainer",children:e("h3",{className:"bold",children:"Modus"})}),e("section",{className:"statistic__contentContainer",children:e("h3",{children:N===0?"-":N})})]}),s("section",{className:"statisticContainer__statistic",children:[e("section",{className:"statistic__titleContainer",children:e("h3",{className:"bold",children:"Min / Max"})}),e("section",{className:"statistic__contentContainer",children:s("h3",{children:[w===1/0?"-":w," / ",k===-1/0?"-":k]})})]})]}),e("section",{className:"OverviewPerGroupPage__chartContainer",children:e(z,{refreshData:P,calculateStatistics:a,rightArray:b,wrongArray:M,unFinishedArray:x,Assignments:t.assignments})})]})}function U({closeModel:t,group_id:d}){const c=G.useRef(),[h,g]=G.useState(!1),N=()=>{const w=new FormData(c.current);return Object.fromEntries(w)},S=w=>{w.preventDefault();let{username:p}=N();if(p=p.trim(),g(!1),p===""||p===null||p===void 0||p.length<3){g("Dit veld mag niet leeg zijn of minder dan 3 karakters bevatten");return}j.Inertia.post(`/docent/overzicht/${d}/${p}`),t()};return s("div",{className:"group__modal",children:[e("div",{className:"group__modal__overlay",onClick:t}),s("div",{className:"group__modal__content",children:[s("div",{className:"group__modal__header",children:[e("h2",{className:"group__modal__title",children:"Nieuwe Leerling"}),e("button",{className:"group__modal__closeButton",onClick:t,children:"X"})]}),e("div",{className:"group__modal__body",children:e("form",{className:"group__modal__form",name:"groupModelForm",ref:c,children:s("div",{className:"group__modal__form__group",children:[e("label",{className:"group__modal__form__label",htmlFor:"username",children:"Gebruikersnaam"}),e("input",{className:`group__modal__form__input ${h&&"invalid"}`,type:"text",name:"username",id:"username",placeholder:"Gebuikersnaam voor de leerling"}),h&&e("div",{className:"group__modal__form__error",children:e("p",{children:h})})]})})}),e("div",{className:"group__modal__footer",children:e("button",{className:"group__modal__submit button-primary",onClick:S,as:"button",children:"Leerling toevoegen"})})]})]})}function L(t){var y;const[d,c]=o.exports.useState(!1),[h,g]=o.exports.useState(!1),[N,S]=o.exports.useState(["",""]),[w,p]=o.exports.useState("");let k=t.allResults,C=t.students,_=t.assignments.length,b=[];for(let a=0;a<C.length;a++){let v=C[a],f={good:0,bad:0,unfinished:_};for(let n=0;n<k.length;n++){let i=k[n];if(v.id===((y=i[0])==null?void 0:y.student_id)){let l=0,m=0,u=_;for(let r=0;r<i.length;r++)i[r].status===1?(l++,u--):i[r].status===-1&&(m++,u--);f={good:l,bad:m,unfinished:u}}}b.push({id:v.id,first_name:v.first_name,results:f,user_id:v.user_id,password:v.password})}const A=()=>{c(!0)},M=()=>{c(!1)},$=a=>{j.Inertia.delete(`/docent/overzicht/${t.group.id}/${a}`)},x=(a,v)=>{let f=a.split(/(?=[A-Z])/);S(f),g(!0),p(v)},R=a=>{j.Inertia.visit(`/docent/overzicht/${t.group.id}/${a}`)},P=()=>{let a="data:text/csv;charset=utf-8,";a+="Naam,Plaatje 1,Plaatje 2",a+=`
`,b.forEach(u=>{let r=u.password.split(/(?=[A-Z])/);a+=`${u.first_name},${r[0]},${r[1]}`,a+=`
`});let v=encodeURI(a),f=document.createElement("a");f.setAttribute("href",v);let n=new Date,i=n.getDate(),l=n.getMonth()+1,m=n.getFullYear();f.setAttribute("download",`wachtwoorden_${t.group.school_group.replace(/\s/g,"_")}_${i}-${l}-${m}.csv`),document.body.appendChild(f),f.click()};return s(F,{children:[d?e(U,{closeModel:M,group_id:t.group.id}):null,e(O,{content:e(G.Fragment,{children:s("div",{className:"viewpassword__modal",children:[e("button",{className:"viewpassword__close",onClick:()=>g(!1),children:e("span",{className:"material-symbols-outlined",children:"close"})}),s("h3",{className:"viewpassword__title",children:["Wachtwoord van ",w]}),s("div",{className:"viewpassword__password__wrapper",children:[s("p",{className:"viewpassword__password viewpassword__password--1",children:[e("span",{className:"password--bold",children:"Plaatje 1:"})," ",N[0]]}),s("p",{className:"viewpassword__password viewpassword__password--2",children:[e("span",{className:"password--bold",children:"Plaatje 2:"})," ",N[1]]})]})]})}),modelState:h,setModelState:g}),s("section",{className:"student__table__header",children:[e("button",{className:"button button-primary",onClick:P,children:"Download wachtwoorden"}),e("button",{className:"button button-primary",onClick:A,children:"Voeg leerling toe"})]}),s("article",{className:"student__table__container",children:[s("ul",{className:"student__table__row student__table__heading",children:[e("li",{children:"\u200E"}),e("li",{children:e("p",{children:"Leerling"})}),e("li",{children:e("p",{children:"Voortgang"})}),e("li",{children:"\u200E"})]}),e("ul",{className:"student__table",children:b.map(a=>s("li",{className:"student__table__row",children:[e("div",{children:e("figure",{className:"student__item__figure",children:e("img",{className:"student__item__figure__picture",src:`https://avatars.dicebear.com/api/bottts/${a.id}.svg`,alt:`Avatar van ${a.first_name}`})})}),e("p",{className:"student__item__name",children:a.first_name}),s("div",{className:"progress__container",children:[e("div",{className:"progress__bar",children:e("div",{className:"progress__bar__progress",style:{width:`${a.results.good/_*100}%`}})}),s("p",{className:"progress__text",children:[a.results.good," / ",_]})]}),s("div",{className:"student__item__button__wrapper",children:[e("button",{className:"student__item__button student__item__button--password",onClick:()=>R(a.id),children:e("span",{className:"material-symbols-outlined",children:"visibility"})}),e("button",{className:"student__item__button student__item__button--password",onClick:()=>x(a.password,a.first_name),children:e("span",{className:"material-symbols-outlined",children:"password"})}),e("button",{className:"student__item__button student__item__button--delete",onClick:()=>$(a.user_id),children:e("span",{className:"material-symbols-outlined",children:"delete"})})]})]},a.id))})]})]})}function Q(t){const[d,c]=o.exports.useState("statistieken");function h(g){c(g)}return t.students.length<1&&d=="statistieken"&&c("leerlingen"),o.exports.useEffect(()=>{switch(new URL(location.href).searchParams.get("overzicht")){case"statistieken":c("statistieken");break;case"leerlingen":c("leerlingen");break;default:c("statistieken");break}},[]),s(F,{children:[e(D,{first_name:t.employee.first_name}),s("section",{className:"group__overview__container",children:[s("div",{className:"group__overview__container-row",children:[e("div",{className:"group__overview__button__container",children:e(E,{as:"button",href:route("docent.overzicht"),className:"button-primary group__overview__backButton",children:"Terug"})}),s("h1",{className:"group__overview__title",children:["Overzicht ",t.group.school_group]})]}),t.students.length>0&&s("div",{className:"group__overview__menu",children:[e("button",{onClick:()=>h("statistieken"),className:`group__overview__menuItem ${d=="statistieken"?"active":""}`,children:"Groep statistieken"}),e("button",{onClick:()=>h("leerlingen"),className:`group__overview__menuItem ${d=="leerlingen"?"active":""}`,children:"Overzicht leerlingen"})]})]}),d=="statistieken"&&e(I,{allResults:t.allResults,assignments:t.assignments}),d=="leerlingen"&&e(L,{group:t.group,students:t.students,allResults:t.allResults,assignments:t.assignments})]})}export{Q as default};
